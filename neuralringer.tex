%% Hello emacs, this is -*- latex -*-
\typeout{ ====================================================================}
\typeout{ This is file neuralringer.tex, created at 27-Aug-2005 }
\typeout{ Maintained by Andre Anjos <Andre.dos.Anjos@cern.ch> }
\typeout{ ====================================================================}

\chapter{Sistema neural de deteção elétron/jato baseado em Calorimetria}
\label{chap:neural}

Sistemas de calorimetria são normalmente construídos com forma e leitura
segmentada de maneira que possam ser usados diretamente na deteção de
partículas. Isto é possível uma vez que muitos processos interessantes são
distingüíveis pela forma com que depositam energia à medida que interagem com
estes detetores, tanto de forma radial quanto em penetração
\cite{wigmans-book}. Cada segmento ou célula de um calorímetro contém a
informação de energia depositada por uma partícula ou conjunto de partículas
que interagiu com o detetor naquela área específica. A segmentação destes
instrumentos dependerá da física do experimento e também, normalmente, do eixo
de dispersão das partículas de interesse.

Algoritmos de deteção são normalmente concebidos por especialistas em
Calorimetria que entendam os diferentes perfis de interação para a física de
interesse. O primeiro passo é definir um processo de redução de
dimensionalidade, de acordo com a velocidade requerida na deteção. Este
pré-processamento ou Extração de Características (do inglês, \eng{Feature
Extraction} ou FEx) é em geral feito com perda de informação do perfil de
deposição, mas atentivamente de forma que as principais características ainda
sejam bem distingüíveis. Em seguida, tendo por base simulações ou dados reais
da física de interesse, define-se um conjunto de cortes por métodos com
conhecimento da informação \eng{a priori} que maximizem a probabilidade de
deteção das partículas interessantes.

Neste capítulo define-se um sistema de extração de característica em anéis de
deposição energética, associado a um sistema de discriminação neural para
definir um classificador de partículas ótimo para o Segundo Nível de Filtragem
do experimento ATLAS. Este classificador supera significativamente, em
desempenho, um sistema clássico de deteção, é modular, rápido e de simples
manutenção.

\section{Calorimetria em outros experimentos}

Introduzir um histórico de das diversas técnicas até hoje. Hera, D0, LEP.

\section{Importância da Calorimetria no Experimento ATLAS}

O Sistema de Filtragem \eng{online} do experimento ATLAS deverá prover uma
seleção de eventos muito eficiente e desprovida de tendências, mantendo o
potencial de descoberta do detetor. Deve ser extremamente flexível de forma a
operar no ambiente desafiador do LHC, com até 23 colisões inelásticas por
interação, 14~TeV no centro de impacto e apenas 25~ns (40~MHz) apenas entre
colisões sucessivas. Além disso, deve prover critérios de seleção robustos e,
onde possível, redundantes. É altamente desejável a rejeição de canais
ruidosos, não interessantes ou falsos o mais rápido possível de forma a
otimizar o uso dos recursos computacionais disponíveis.

Para trazer uma eficiência compatível com este árduo ambiente, o Sistema de
Filtragem fará uso de um enfoque baseado na \textbf{inclusão} para a seleção
\eng{online}, garantindo assim um conjunto de
\eng{triggers} ótimo para a nova Física. O critério da inclusão tem por
objetivo selecionar um conjunto de fenômenos físicos baseados no ``mínimo
denominador comum" entre eles, que ainda seja claramente distingüível dentro
do ruidoso ambiente proposto pelo acelerador. Com este objetivo, o Sistema de
Filtragem estará sendo disparado para eventos que contenham assinaturas
baseadas em objetos simples ou duplos com alto valor de momento
transverso. Neste contexto, ``objetos com alto valor de momento transverso"
refere-se, entre outros, a leptons com carga e com momento transverso acima de
$\sim$10 GeV \cite{hlt-tdr}.

\subsection{Objetos de interesse e RoI's}

Foi visto no Capítulo~\ref{chap:trigger} que o LVL1 define, para objetos
encontrados seja nos Calorímetros ou nos Detetores de Múons, regiões de
interesse onde objetos relevantes tenham sido observados. Para cada objeto
interessante, a região aproximada de interação do objeto com o detetor é
anotada e repassada aos demais níveis de filtragem, no caso da aprovação do
evento. Este processo define as Regiões de Interesse ou RoI's (do inglês
\eng{Regions of Interest}), que guiarão o processo de seleção nos Altos Níveis
de Filtragem (do inglês, \eng{High-Level Triggers} ou HLT).

De fato, dado as condições do feixe provido pelo LHC, múltiplos objetos
poderão ser detetados a cada evento. Porém, quando um ou mais objetos
detetados ativam a aceitação do evento, o LVL1 marca o dado de forma especial,
distingüindo este objeto como primário, em contraste com aqueles que também
foram detetados, mas não fizeram objeto da aceitação deste nível de
filtragem. A Tabela~\ref{tab:l1-rates} apresenta as taxas (simuladas) para as
diferentes assinaturas de interesse, ou conjuntos de objetos primários, que
serão entregues pelo Primeiro Nível de Filtragem~\cite{hlt-tdr} ao HLT,
encabeçados pelo LVL2, para a luminosidade inicial de
$2\times10^{33}cm^{-2}s^{-1}$.

\begin{table}
\begin{center}
\begin{sideways}
\begin{tabular}{|l|r|}
\hline
\textbf{Assinatura do LVL1} & \textbf{Codinome} &
	\textbf{Taxa de Eventos (kHz)} \\ \hline
e.m., 25 GeV, com isolamento & \texttt{EM25i} & 12 \\ \hline
2 $\times$ e.m., 15 GeV, com isolamento & \texttt{2EM15i} & 4 \\ \hline
Múon, 20 GeV & \texttt{MU20} & 0.8 \\ \hline
2 $\times$ múon, 6 GeV & \texttt{2MU6} & 0.2 \\ \hline
Jato, 200 GeV & \texttt{J200} & 0.2 \\ \hline
3 $\times$ jato, 90 GeV & \texttt{3J90} & 0.2 \\ \hline
4 $\times$ jato, 65 GeV & \texttt{4J65} & 0.2 \\ \hline
Jato, 60 GeV $+$ \textit{Missing Energy}, 60 GeV & \texttt{J60} $+$
\texttt{XE60} & 0.4 \\ \hline
$\tau$, 25 GeV, com isolamento $+$ \textit{Missing Energy}, 30 GeV &
\texttt{TAU25i} $+$ \textt{XE30} & 2 \\
\hline
Múon, 10 GeV $+$ e.m., 15 GeV, com isolamento & \texttt{MU10} $+$ \texttt{EM15i} & 0.1 \\ \hline
Outros disparos (pre-escalonados, aleatórios, monitoração, calibração) & -- & 5 \\
\hline
Total & $\sim$25 \\ \hline
\end{tabular}
\end{sideways}
\end{center}
\caption{Taxas de saídas para as assinaturas reconhecidas pelo LVL1,
para a luminosidade de pico inicial de $2\times10^{33}cm^{-2}s^{-1}$. Dados
baseados em uma simulação do LVL1.}
\label{tab:l1-rates}
\end{table}

Nota-se que, aproximadamente 16 dos 25 kHz (i.e. $\sim$65\% das assinaturas)
entregues pelo LVL1 conterão objetos tipo e.m.. Estes objetos são assim
classificados por representarem elétrons \textbf{ou} fótons, que interagem com
os detetores à partir de interações eletromagnéticas ao invés das componentes
hadrônicas presentes em outros casos. 

\subsection{Análise do Sistema de Filtragem com relação à Física}

A Figura~\ref{fig:trigger-physics} apresenta um diagrama esquemático que
despreza as interfaces em \eng{hardware} propostas pela construção do Sistema
de Filtragem e tenta enfocar melhor o problema do ponto de vista da análise
dos canais físicos \eng{per se}. Da esquerda para a direita, observa-se a
seqüência de eventos que indicam a completa aceitação de um evento por parte
do Sistema de Filtragem. O caso de estudo é um evento que será aprovado por
conter um elétron com isolamento, e uma energia mínima de 25 GeV. 

\begin{figure}
\begin{center}
\includegraphics[scale=0.9]{trigger-physics}
\end{center}
\caption{Diagrama esquemático do Sistema de Filtragem do Experimento ATLAS
segundo suas funções de filtragem.}
\label{fig:trigger-physics}
\end{figure}

O processamento começa à medida que o LVL1 recebe o sinal do LHC acusando o
iminente cruzamento de pacotes (do inglês \eng{Bunch Crossing}) no ponto de
impacto. Uma janela de aquisição de alguns nanossegundos fará com que o
Sistema de Leitura do Detetor registre o evento. Os sistemas de
pré-processamento do LVL1 são ativados paralelamente. No caso dos
Calorímetros, somadores rápidos \cite{seixas:adder} agrupam as informações das
células dos calorímetros e.m. e hadrônicos, formando 2 planos com
granularidade reduzida \cite{l1-tdr}. Em ambas seções do calorímetro (e.m. e
hadrônica) este pré-processamento forma macro-células de filtragem ou
``torres" de filtragem (do inglês, \eng{Trigger Towers}, ou TT) com tamanho
$0,1\times0,1$ no plano $\eta\times\phi$. As diversas sub-camadas de cada
seção do calorímetro são colapsadas em um único plano por seção. Estes planos
com granularidade minimizada são varridos pelos diversos processadores do LVL1
e os objetos de interesse localizados no detetor. Para a deteção de um objeto
tipo e.m. requer-se normalmente que perceba-se pouca (ou nenhuma) energia na
seção hadrônica e que grande parte da energia do objeto esteja concentrada
numa região $0,2\times0,2$ ao redor do ponto estimado de impacto
(isolamento). A energia deste núcleo deve ser maior que o corte imposto pelo
sistema de filtragem; no atual caso de estudo, 25 GeV ao menos. Os valores de
corte e isolamento são configuráveis.

É interessante perceber que múltiplas assinaturas podem ser detetadas em um
único evento para além do fato de que múltiplas RoI's secundárias possam estar
presentes. Uma lista das assinaturas encontradas e das diversas RoI's
averigüadas pelo LVL1 são repassadas para o LVL2, no formato de uma única
mensagem conhecida como o ``Resultado do Primeiro Nível de Filtragem", ou L1R,
como visto na Seção~\ref{sec:lvl2arch}. No caso da assinatura sendo estudada,
ao menos uma RoI primária, indicando um objeto tipo e.m., com ao menos 25 GeV
estará presente no L1R.

O processamento no LVL2 é seqüencial. Ao receber um L1R, o Guia de Execução do
LVL2 (do inglês, \eng{Steering}) chamará um componente para a confirmação do
disparo do LVL1. O componente em questão poderá transferir do Sistema de
Leitura do Detetor, a quantidade de dados que achar necessária, ao redor da
RoI, para processá-la. Se não for possível rejeitar a assinatura do LVL1, o
\eng{Steering} poderá chamar mais e mais componentes até que o evento seja
rejeitado ou definitivamente aprovado ao Terceiro Nível de Filtragem ou Filtro
de Eventos (do inglês \eng{Event Filter} ou EF). Neste último caso, de forma
equivalente a relação entre o LVL1 e o LVL2, o LVL2 enviará um sumário
indicando a razão da aceitação do evento, e valores refinados de energia,
momento e localização dos objetos explorados em seu contexto ao EF. Espera-se
que o LVL2 atinja uma redução da taxa de eventos, dos 25~kHz inicialmente
cedidos pelo LVL1 para não mais que alguns (1 ou 2) kHz. O tempo médio de
processamento deve estar na ordem dos 10~ms. Note que este valor representa a
média de processamento por evento. De fato espera-se que eventos de interesse
utilizem mais tempo de processamento enquanto que eventos pouco ou nada
interessantes sejam rapidamente descartados.

Neste contexto entende-se que, quanto menor o tempo necessário e maior a
qualidade da deteção dos diversos componentes do sistema de filtragem, mais
tempo computacional será despendido com a Física de interesse e menos recursos
com eventos que representem Física ordinária ou incorretamente detetada.

No EF a análise do evento começa com 100\% dos dados do evento e os resultados
dos nível precedentes (L1R e L2R). Neste nível de filtragem, correlações mais
complexas podem ser feitas entre as diferentes RoI's, e uma análise mais
depurada do evento poderá ser conduzida. Por exemplo, é possível se fazer uso
das RoI's secundárias para atingir maior redução da taxa de eventos a ser
registrada em mídia permanente. Se aprovado, o evento é guardado, devidamente
``etiquetado" e re-passado às fazendas de processamento \eng{offline} para
posterior reconstrução.

\paragraph{Contaminação} O \eng{trigger} de elétrons ou fótons conterá forte
contaminação de jatos com poucas componentes hadrônicas, difícil de deteção
observando-se a granularidade disponível no LVL1. Somente no LVL2, o Sistema
de Filtragem, disporá do tempo e da completa granularidade do detetor para
executar uma seleção mais criteriosa. Estima-se em \cite{daqnote00-02}, que a
cada 25.000 objetos do tipo e.m., aprovados pelo LVL1, apenas 1 será um
elétron ou fóton.

\section{Deteção de elétrons baseada em Calorimetria}
\label{sec:e-detection}

A Figura~\ref{fig:e-shower} mostra a interação de um elétron com um detetor de
traços (\eng{Cloud Chambers}) e absorvedores de chumbo. Nesta figura é
possível observar a formação de um chuveiro de partículas que diverge
aproximadamente isotropicamente do eixo de penetração do elétron. No caso de
elétrons \cite{wigmans-book}, a dispersão é menor que no caso de jatos de
partículas, já que há uma grande probabilidade de espalhamento múltiplo (do
inglês \eng{Multiple Scattering}) causado pelas componentes hadrônicas do
conjunto de partículas. A distância de penetração é diretamente propocional a
energia do objeto em análise \cite{leo, knoll}, ainda que, para os mesmos
valores energéticos, jatos tendam a penetrar mais profundamente nos aparatos.

\begin{figure}
\begin{center}
\includegraphics[scale=0.4]{e-cloud-chamber}
\end{center}
\caption{Interação de um elétron com um detetor de traços com absorvedores em
chumbo.} 
\label{fig:e-shower}
\end{figure}

CONSEGUIR FOTO DE UMA ROI COM O DÊNIS: ELECTRON, JET?

A deteção de elétrons beneficia-se deste conhecimento básico para
distingüí-los de sua contaminação natural de jatos (e píons). Numa primeira
fase, chamada de Extração de Características, avalia-se para uma região do
detetor, normalmente centralizada em um ponto pré-determinado, um conjunto de
valores que representem, o melhor possível, os perfis de deposição lateral (ou
radial) do objeto sendo estudado e sua penetração no aparato. Este processo
comprime\footnote{Define-se ``compressão" a técnica pelo qual reduz-se a
dimensionalidade de um sinal em um espaço bem definido, preservando ou
tentando preservar a informação relevante que caracteriza este sinal de
interesse. A transformação do espaço original para o espaço ``comprimido" é
irreversível. A ``compressão" de sinais é muitas vezes denominada
``compactação com perdas".} a informação de entrada, que normalmente possui
dimensionalidade bastante elevada (O(100)-O(1000)), para um conjunto pequeno
(O(10)) de varíaveis que possam ser analisadas mais facilmente.

A questão da dimensionalidade da entrada está intimamente correlacionada com a
capacidade discriminante do calorímetro. Quanto mais granular, maior precisão
pode ser obtida na definição de pontos de impacto e deteção de partículas. O
revés é o custo - detetores multi-segmentados são mais difíceis e caros de
serem construídos.

No caso do experimento ATLAS (veja a Seção~\ref{sec:atlas-calo} para mais
detalhes), os calorímetros são segmentados em diversas camadas, e, camada a
camada, granularizados em células de deposição energética. A granularidade
varia camada a camada pois cada uma delas possui um objetivo distinto de
emprego: as camadas iniciais tem por objetivo a discriminação de elétrons e
fótons e estimativa de posicionamento, as mais traseiras a deteção de
hádrons. As camadas da seção e.m. tem profundidade variante, sendo que a
segunda (EM2, a contar do zero, ou seja o pré-irradiador), tem a maior
profundidade de todas, ocupando mais de 80\% do volume total desta seção.

Para elétrons com valores energéticos até algumas dezenas de
gigaelétron-volts, espera-se que a maior parte da energia do objeto esteja
depositada nesta camada. A granurilade é bastante regular e semelhante tanto
ao longo do eixo $\eta$ quanto ao longo de $\phi$, como é possível observar na
Tabela~\ref{tab:lar}. Esta tabela também mostra o fator de compressão (ou
tamanho da torre de filtragem) $N_{\eta} \times N_{\phi}$ aplicado ao processo
de agrupamento necessário ao préprocessamento antes da análise encaminhada
pelo LVL1.

A seção hadrônica dos calorímetro é bastante menos granular. O tamanho padrão
da célula é $0,1\times0,1$ no espaço $\eta\times\phi$ uma vez que seja
otimizado para detetar hádrons. Esta classe de partículas penetra mais
profundamente na matéria e desenvolve complexas cascatas ao longo da
penetração, normalmente pouco interessantes, mais que devam ser contidas no
espaço do detetor. O agrupamento padrão (torre de filtragem) para LVL1 é de
$2\times2$ células.

A Figura~\ref{fig:e-jet-deposit} mostra histogramas da relação da deposição
energética na seção hadrônica e a energia total do objeto considerando-se uma
área $0,4\times0,4$ no plano $\eta\times\phi$. Os eventos considerados são
simulações de elétrons e jatos cobrindo um campo energético de algumas dezenas
de GeV até 90 GeV interagindo com os calorímetros do ATLAS. Os eventos
selecionados passaram uma simulação realística do LVL1 e portanto representam,
todos, eventos que seriam classificados como elétrons por este nível de
filtragem. Observa-se que para jatos há uma probabilidade maior de depósito na
seção hadrônica que na seção e.m..

\begin{figure}
\begin{center}
\includegraphics[scale=0.95]{em-had-percent}
\end{center}
\caption{A relação energética da deposição na seção hadrônica e energia total para
elétrons (topo) e jatos (baixo).}
\label{fig:e-jet-deposit}
\end{figure}

\paragraph{Classificação -} A fase seguinte à compressão do espaço original
de entrada é a discriminação da Física de interesse. Tipicamente
\cite{hlt-tdr, zeus-neural} a deteção é realizada por meio da definição de
patamares de separação (também ditos \emph{cortes}) com informação \emph{a
priori} \cite{vantrees}. Este trabalho é normalmente realizado por um físico
experiente, de acordo com a importância da física de interesse analisada. 

É importante salientar que o melhor classificador baseado em cortes cortes com
informação \emph{a priori} também pode ser atingido iterativamente através de
utilização de Discriminadores de Fisher \cite{haykin-adaptative},
opcionalmente com atribuição de pesos para cada classe de partículas,
definindo importâncias diferentes aos diferentes tipos de objetos estudados.

A Figura~\ref{fig:basic-discriminator} mostra um diagrama esquemático do
processo clássico de deteção descrito. No centro lógico do processo
encontra-se o físico experiente, que controla o grau de compressão e
capacidade discriminante do sistema. Este sistema possui um conjunto de
problemas inerentes a intervenção humana na otimização, dentre eles a
dependência no operador (aqui representado pela figura do "físico
experiente"). O procedimento de compressão e discriminação deve ser bem
documentado para que seja possível a reprodução dos resultados em todos os
momentos. Ademais, o ajuste fino poderá ser bastante tedioso e dependente da
quantidade de dados analisados, uma vez que o processo realizado será
semi-automático - i.e., seleção dos dados de interesse seguido de análise
manual.

\begin{figure}
\begin{center}
\includegraphics[scale=0.5]{basic-discriminator}
\end{center}
\caption{Um sistema \eng{ad-hoc} de deteção com uma entrada com alta
dimensionalidade.}
\label{fig:basic-discriminator}
\end{figure}

\subsection{Compressão minimizada}

Em um sistema com a dimensionalidade de entrada tão elevada como se apresenta
o problema da discriminação elétron/jato para o Detetor ATLAS, é mais
interessante a proposição de um sistema onde a otimização seja conduzida por
bases matemáticas mais automáticas e maximamente livres de
polarização. Idealmente este sistema utilizaria todas as entradas para definir
as regras de compressão e relevância de cada componente na discriminação dos
alvos. Infelizmente, com o aumento da dimensionalidade da entrada diminui-se
exponencialmente as chances de convergência na procura de uma função que
defina otimamente ou de forma aproximada, uma separação das classes a serem
discriminadas \cite{haykin}. É razoável supor que, quanto maior a
dimensionalidade da entrada, mais dados serão necessários para atingir-se uma
discriminação suficientemente boa. 

Desta forma um sistema de compressão mínima dos dados se faz necessária. Este
sistema de compressão deve tentar minimizar a perda de informação e maximizar
o potencial discriminativo do sistema. Um discriminador capaz de definir um
plano de separação em um espaço de entrada com dimensionalidade elevada também
será necessário, uma vez que deseja-se compressão mínima dos dados de
entrada. A Figura~\ref{fig:advanced-discriminator} mostra uma idealização de
tal sistema discriminante. A primeira etapa é uma compressão mínima da
entrada, que seja compatível com um sistema de deteção que aceite sinais com
alta-dimensionalidade na entrada. Idealmente, um sub-sistema de ``otimização"
dos parâmetros de compressão e discriminação, também automatizado, controlaria
a compressão da entrada melhorando a relação custo computacional \eng{versus}
qualidade de deteção.

\begin{figure}
\begin{center}
\includegraphics[scale=0.5]{advanced-discriminator}
\end{center}
\caption{Um sistema \eng{ad-hoc} de deteção sub-ótimo com uma entrada com alta
dimensionalidade.}
\label{fig:advanced-discriminator}
\end{figure}

\section{Deteção de Elétrons no LVL2}
\label{sec:lvl2-detect-electron}

O LVL1 (Seção~\ref{sec:lvl1}) executa seu procedimento de filtragem procurando
elementos nos calorímetros e detetores de múons que obedeçam a certos
critérios de classificação. A Tabela~\ref{tab:l1-rates} mostrada anteriormente
indica os principais objetos interessantes neste nível de filtragem. No caso
de objetos e.m. (elétrons e fótons), o algoritmo pode ser resumido da seguinte
forma:

\begin{enumerate}
\item Os sinais analógicos provenientes das células do detetor são agrupados
em macro-células chamadas Torres de Filtragem (do inglês \eng{Trigger Towers},
TT). A taxa de agrupamento não é uniforme, mas num geral forma TT's com
$0,1\times0,1$ no plano $\eta\times\phi$ para a seção eletromagnética do
calorímetro e $0,2\times0,2$ na seção hadrônica.

\item Os sinais somados das TT's são digitalizados e disponibilizados para a
lógica de leitura do LVL1;

\item Processadores especializados (4 no total) cobrem diferentes áreas do
detetor e utilizam um algoritmo de agrupamento baseado em uma janela
deslizante \cite{l1-tdr} cobrindo uma região de $4\times4$ TT's (16 no
total) aqui resumido:

\begin{enumerate}
\item Se o núcleo de $2\times2$ TT's contiver energia maior que a
periferia, para um determinado patamar programável, um candidato a RoI é
definido;

\item Em seguida soma-se, duas a duas, as enegias transversas das TT's do
núcleo de $2\times2$ TT's e utiliza-se a maior das somas em uma comparação com
um patamar de energia EM;

\item Caso passe a este critério, a energia na periferia da RoI-candidata é
verificada para assegurar o isolamento do objeto; 

\item O último critério é o isolamento hadrônico onde o LVL1 verifica se não
há grande depósito de energia (transversa) na seção hadrônica.
\end{enumerate}  

No caso de atender a todos os pré-requisitos, o objeto candidato é promovido a
uma RoI tipo e.m.. Este algoritmo está representado na
Figura~\ref{fig:l1-calo}.
\end{enumerate}

\begin{figure}
\begin{center}
\includegraphics[scale=0.78]{l1-calo}
\end{center}
\caption{Representação gráfica do algoritmo de deteção de objetos e.m. no LVL1.}
\label{fig:l1-calo}
\end{figure}

Os diversos sub-módulos do LVL1 irão detetar e pré-classificar os elementos de
interesse para jatos, múons e energia faltante. Em seguida:

\begin{enumerate}
\item Os objetos detetados e seus pontos \textbf{centrais} de impacto
estimados no plano $\eta\times\phi$, ou seja, as RoIs, são encaminhados ao
Processador Central do Sistema de Filtragem do LVL1 (do inglês \eng{Central
Trigger Processor}, CTP) e uma decisão é feita levando-se em consideração as
assinaturas de interesse e resultados dos processamentos de outros módulos
(jatos, energia faltante e múons). A decisão de aprovar um evento é tomada
baseando-se em RoI's de acordo com critérios de preferência estipulados \eng{a
priori}. As RoI's que são utilizadas para a decisão de aprovação são rotuladas
``primárias" ao passo que as demais, ``secundárias";

\item Um sumário do resultado e das RoI's encontradas, já rotuladas (primárias
e secundárias) é repassado, através do \eng{RoI Builder} ao LVL2.
\end{enumerate}

O Segundo Nível de Filtragem do experimento ATLAS é a primeira vez onde o
evento será analisado tendo por base a granularidade máxima do detetor. O
objetivo deste nível de filtragem, de uma forma geral, é a confirmação das
informações do LVL1 e eventual depuramento e extensão. Aproveitando-se de toda
a granularidade disponibilizada pelo sistema de leitura do detetor, o LVL2
começa analisando o evento através das RoI's classificadas como primárias pelo
LVL1.

Ao receber as informações das RoI's o \eng{Steering} ativará o passo de
decodificação do resultado do LVL1 e, em seguida, selecionará a próxima fase
de análise, que dependerá diretamente do tipo RoI's primárias do evento. No
caso de RoI's do tipo e.m., um algoritmo de deteção de elétrons (e fótons)
será ativado.

\subsection{Deteção de elétrons no LVL2: O T2Calo e EGammaHypho}
\label{sec:classic-detection}

Como discutido anteriormente na Seção~\ref{sec:e-detection}, o processo de
deteção veloz baseado em calorimetria pode ser sub-dividido em passos distintos:

\begin{enumerate}
\item Compressão do sinal de entrada;
\item Deteção da física de interesse baseada no espaço comprimido.
\end{enumerate}

Para o ATLAS, a fase 1 irá comprimir o espaço de entrada definido pelas
células da RoI em questão em 4 variáveis com alto poder discriminante, baseado
na percepção da física de interesse e da contaminação esperada. No caso de
elétrons, espera-se que haja forte contaminação de jatos com muitas
componentes e.m.. Desta forma, a compressão do sinal de entrada tentará
realçar informações como a dispersão do objeto na RoI ou a profundidade de
interação do objeto com as diversas camadas do detetor. 

O nome do algoritmo usado para a FEx de RoI's primárias tipo e.m. é
\emph{T2Calo}, uma variação das palavras \eng{Trigger}, LVL2 e
Calorimetria. As variávies extraídas do \eng{cluster} definido pela RoI do
LVL1, por este algoritmo, são, em ordem:

\begin{enumerate}
\item \textbf{Centro de Impacto Refinado}, Figura~\ref{fig:t2calo-1}: O
primeiro passo do algoritmo é um refinamento do centro da RoI. Isto é feito
encontrando-se o pico de deposição energética na segunda camada da seção
eletromagnética do calorímetro, que é também a mais profunda (veja uma
discussão mais detalhada na Seção~\ref{sec:atlas-calo}) desta seção. O valor
do centro da célula é tomado como nova estimativa de posicionamento da RoI e
será utilizado para os cálculos seguintes;

\item \textbf{$\text{Energia}^{e.m.2}_{3 \times 7}$},
Figura~\ref{fig:t2calo-1}: O segundo passo é calcular as somas dos valores de
deposição energética, para a segunda camada e.m., numa região de tamanho
$\eta=0,075 \times \phi=0,175$ ao redor do centro de impacto definido
anteriormente. Esta soma é assim designada devido à granularidade de base da
segunda camada e.m., para cada célula, de aproximadamente $0,025 \times
0,025$;

\item \textbf{$\text{Energia}^{e.m.2}_{3 \times 7}$},
Figura~\ref{fig:t2calo-1}: Em seguida calcula-se as somas dos valores de
deposi\-ção ener\-gé\-tica, para a segunda camada e.m., numa região de tamanho
$\eta=0,175 \times \phi=0,175$ ao redor do centro de impacto definido no
primeiro passo;

\begin{figure}
\begin{center}
\includegraphics[scale=0.8]{t2calo-1}
\end{center}
\caption{T2Calo, Etapa 1: Cálculo do centro refinado e deposições de
energia na segunda camada e.m., para regiões $3\times7$ e $7\times7$ no plano 
$\eta\times\phi$.}
\label{fig:t2calo-1}
\end{figure}

\item \textbf{Máximos em e.m.1}, Figura~\ref{fig:t2calo-2}: Os dois maiores
picos de energia na primeira camada da seção e.m. são detetados;

\begin{figure}
\begin{center}
\includegraphics[scale=0.8]{t2calo-2}
\end{center}
\caption{T2Calo, Etapa 2: Procura dos dois maiores picos na primeira camada e.m..}
\label{fig:t2calo-2}
\end{figure}

\item \textbf{Energia e.m.}, Figura~\ref{fig:t2calo-3}: Embora não utilizados
diretamente para o processo discriminativo, os valores parciais de deposição
energética para cada camada da seção e.m., numa região de $\eta=0,075 \times
\phi=0,175$, também são calculados;

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{t2calo-3}
\end{center}
\caption{T2Calo, Etapa 3: Valores parciais e somatório das energias, em uma
área equivalente a $3\times7$ células na segunda camada e.m., para as demais
camadas da seção e.m..}
\label{fig:t2calo-3}
\end{figure}

\item \textbf{$\text{Energia Hadrônica}_{2 \times 2}$}: Calcula-se a energia
total num espaço $\eta=0,2 \times \phi=0,2$ tomando-se os valores das células
cujo o centro recai sobre a região definida em cada camada da seção hadrônica;

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{t2calo-4}
\end{center}
\caption{T2Calo, Etapa 4: Valores parciais e somatório das energias, em uma
área equivalente a $0,2\times0,2$ no plano $\eta\times\phi$, para as camadas
da seção hadrônica.} 
\label{fig:t2calo-4}
\end{figure}

\end{enumerate}

O algoritmo de deteção propriamento dito segue a execução do T2Calo e é
chamado \emph{EGammaHypho}. Este algoritmo tem a função exclusiva de combinar
as informações disponíveis dos diversos algoritmos de FEx relacionados à
deteção de elétrons e fótons e tomar uma decisão simples baseada nas
propriedades físicas das partículas de interesse. No caso de RoI's tipo e.m.,
o EGammaHypho é também executado logo após a execução do T2Calo visando uma
rejeição rápida da física responsável pelo ``ruído" (ou \eng{background}), ou
seja, jatos. As vantagens deste processo de rejeição ``antecipada" foram
discutidas no Capítulo~\ref{chap:trigger}.

Uma vez que a quantidade de informações disponível neste momento encontra-se
somente nos parâmetros pré-definidos pelo T2Calo, o EGammaHypho definirá uma
seqüência simples de discriminadores baseados em combinações lineares e
não-lineares destas quantidades. As quantidades de interesse do EGammaHypho
são: 

\begin{enumerate}
\item \textbf{Centros refinados da RoI}: Procurando-se o pico de deposição
energética na segunda camada e.m., utilizando a granularidade máxima do
detetor, é possível refinar o ponto de impacto do objeto. Estes valores serão
utilizados para o cálculo das demais variáveis do T2Calo;

\item \textbf{\rcore}: Representa a razão entre a soma das células na segunda
camada e.m., numa área de $3 \times 7$ células por $7 \times 7$ células ao
redor da célula na segunda camada que apresenta o maior valor de energia
depositado, como calculado na Etapa~1 do T2Calo. Esta quantidade mede o
espalhamento da cascata formada pelo decaimento do objeto de estudo. No caso
do objeto ser um jato, espera-se que a cascata tenha um espalhamento maior que
no caso de elétrons, resultando em um valor menor que 1 para esta quantidade;

\item Cálculo de \textbf{\eratio}: Uma vez que jatos de par\-tí\-culas
interagem de forma mais espalhada do que e\-lé\-trons, espera-se que na
primeira camada e.m. sejam observados vários picos. Definindo um pico ($E$)
como sendo a ocorrência de um máximo registrado pela célula central de um
agrupamento de três células adjacentes, então, a quantidade \eratio\
representa a razão de energias \eratio$=\frac{E_1-E_2}{E_1+E_2}$. Ou seja, a
razão da subtração pela soma dos valores de energia dos dois picos mais
energéticos na primeira camada e.m., como calculado na Etapa~2 do T2Calo.

Se o objeto for um elétron (objeto único), espera-se que $E_2=0$, já que a
cascata de partículas que o elétron forma na sua interação com o calorímetro
é, tipicamente, bastante estreita, e portanto \eratio=1. Para jatos,
normalmente, \eratio\ será menor que 1, já que $E_2 \neq 0$;

\item \textbf{\etem}: Esta quantidade representa a soma das energias das
células da seção e.m. dos calorímetros, cujo centro recai sobre uma região de
$0,075 \times 0,175$ no plano \ep, ao redor do centro da célula da segunda
camada e.m. que apresenta o maior valor de energia depositada, como calculado
na Etapa~3 do T2Calo. O valor original calculado é dividido pelo
$\cosh{|\eta|}$ para que obtenha-se a energia tranversa\footnote{O termo
``transverso" neste contexto refere-se ao feixe de partículas.} (projetada no
plano $x \times y$ do detetor). A região na qual esta quantidade é extraída
equivale, usando-se a granularidade da segunda camada e.m., a uma região de 3
células na direção $\eta$ por 7 células na direção de $\phi$. Espera-se que a
energia de elétrons esteja totalmente contida nesta janela; por seu turno,
jatos devem apresentar, hipoteticamente, uma fração menor de sua energia
depositada nesta área;

\item \textbf{\ethad}: Esta quantidade representa a soma das células na
primeira camada da seção hadrônica do calorímetro dentro de uma região de $0,2
\times 0,2$ no plano \ep, ao redor do centro da célula na segunda camada
e.m. que apresenta o maior valor de energia depositada, como calculado na
Etapa~4 do T2Calo. O valor também é divido por $\cosh{|\eta|}$ para que
obtenha-se o valor de energia tranversa. Para elétrons, a quantidade de
energia depositada na camada hadrônica deve ser próxima de zero, enquanto que,
para jatos, espera-se que seja diferente de zero.
\end{enumerate}

A seqüência discriminativa está representada a seguir, em pseudo-código:

\newcommand{\textbu}[1]{\textbf{\underline{#1}}}
\newcommand{\IF}[1]{\textbu{se} #1, \textbu{então}}
\newcommand{\RETURN}[1]{\\ \textbu{retornar} #1\textbf{;}}
\newcommand{\EVALTWO}[3]{\textbu{calcular} #1(#2, #3)\textbf{;}}
\newcommand{\lumihi}{\ensuremath{10^{33} \text{cm}^{-2}\text{s}^{-1}}}

\begin{description}
\item[\ding{182}] \EVALTWO{\eratio}{$E_1$}{$E_2$}
\item[\ding{183}] \EVALTWO{\rcore}{$\text{Energia}^{e.m.2}_{3\times7}$}{$\text{Energia}^{e.m.2}_{7\times7}$}
\item[\ding{184}] \EVALTWO{\etem}{Energia e.m.$_{3\times7}$}{$|\eta|$}
\item[\ding{185}] \EVALTWO{\ethad}{Energia had.$_{0,2\times0,2}$}{$|\eta|$}

\item[\ding{186}] \IF{centro da RoI em e.m.2 distante ($\gtrapprox 0,1$) do
definido pelo LVL1}
	\RETURN{\textbf{não é} elétron}

\item[\ding{187}] \IF{$\rcore \lessapprox 0,9$}
	\RETURN{\textbf{não é} elétron}

\item[\ding{188}] \IF{$\eratio \lessapprox 0,75$}
	\RETURN{\textbf{não é} elétron}

\item[\ding{189}] \IF{$\etem \lessapprox 25$ GeV, L = \lumihi}
	\RETURN{\textbf{não é} elétron}

\item[\ding{190}] \IF{$\ethad \gtrapprox 1$ GeV, L = \lumihi}
	\RETURN{\textbf{não é} elétron}

\end{description}

Se o objeto definido pelo LVL1 conseguir passar todos os critérios definidos
neste procedimento, é promovido a ``candidato à elétron" dentro do LVL2. As
fases seguintes de discriminação tentarão encontrar um traço, com momento
equivalente a energia do \eng{cluster}, e uma nova rodada de hipóteses
confirmará (ou não) o elétron. A procura de traços nos detetores internos é um
procedimento tipicamente lento (na ordem de dezenas, dependendo centenas de
milissegundos \cite{hlt-tdr}), e deve ser evitada tanto quanto possível. Por
outro lado, deseja-se que o sistema de deteção preliminar, baseado em
calorimetria seja o mais rápido possível, mas mantendo bons níveis de
discriminação como já discutido.

Uma das estratégias em consideração atualmente, pondera sobre a utilização dos
diversos estágios de hipótese de forma seqüencial, durante a extração de
característica. Neste caso, após interagir com a segunda camada e.m., o T2Calo
seria brevemente parado e a primeira das hipóteses verificada, criando
recursos para uma rejeição ainda mais antecipada. Em seguida, os dados da RoI
para a primeira camada e.m. seriam carregados no processador, a segunda
variável seria calculada e mais uma rodada de decisão seria tomada. As
próximas etapas seriam a carga dos dados da terceira camada e.m. e do
pré-irradiador, seguindo-se da análise de dados na seção hadrônica. 

\subsubsection{Ajuste fino para cada canal}

Para cada uma das assinaturas de interesse aprovadas pelo LVL1, o segundo
nível contará com algoritmos e sistemas de hipótese adequados àquela física. É
interessante notar que mesmo para os canais similares, e.g. (vide a
Tabela~\ref{tab:l1-rates}) \texttt{EM25i} e \texttt{EM15i}, os cortes impostos
pelo algoritmo de hipótese serão otimizados para estas categorias de
energia. 

%Neste trabalho estaremos comparando os diversos algoritmos de deteção
%utilizando um conjunto de eventos destinado ao estudo da discriminação
%elétron/jato no contexto da assinatura mais freqüente do experimento:
%\texttt{EM25i}.

\subsection{Caracterização do T2Calo e do EGammaHypho}

Para a caracterização de operação do T2Calo e do algoritmo de hipótese
associado, os seguintes grupamentos de dados foram considerados:

\begin{itemize}
\item Cerca de 23.000 elétrons simulados via Monte Carlo, proveniente de
interações tipo $H (130 \text{GeV})\rightarrow ZZ \rightarrow 4e^-$ e 
$H (130 \text{GeV})\rightarrow ZZ \rightarrow 2e^- + 2\mu$. Os elétrons de
cada evento simulado interagem com diferentes regiões do detetor;
\item Cerca de 250.000 jatos simulados via Monte Carlo, com energia total,
fixa em 25 GeV. 
\end{itemize}

Nos dois casos, considerou-se simulações com ruído, proveniente da eletrônica
e uma planta de detetor compatível com o que está sendo instalado atualmente
na caverna do experimento, provendo um ambiente bastante acurado dentro do que
se é possível prever em termos de operação, mas ainda exequível em um ambiente
de simulação.

Esta massa original de dados foi submetida a uma simulação do LVL1, que
implementa o algoritmo discutido na Seção~\ref{sec:lvl2-detect-electron},
aceitando todos os eventos com objetos tipo EM com as seguintes
características:

\begin{itemize}
\item ao menos 10 GeV numa região de $2\times2$ torres de filtragem na seção
e.m.;
\item no máximo 4 GeV na região periféria ao núcleo de $2\times2$ torres de
filtragem; 
\item no máximo 2 GeV de depósito na seção hadrônica;
\item qualquer valor para o centro em $\phi$;
\item $\eta$ variando de $-2,5$ a $+2,5$;
\end{itemize}

Um total de cerca de 22.000 elétrons e 7.000 jatos que passariam a um corte
como o proposto acima fazem parte da massa de dados remanescente após estes
cortes. A Figura~\ref{fig:transverse-energy} contém os histogramas de deposição
energética total transversa de elétrons (em cima) e jatos (embaixo), em uma
janela de $0,4 \times 0,4$ no plano $\eta\times\phi$, considerando-se as duas
seções do calorímetro (e.m. e hadrônica). É possível distinguir um corte
acentuado nas redondezas de aproximadamente 20~GeV, que equivale à ação da
simulação do LVL1, como esperado. A cauda e cabeça da distribuição são
influenciadas pela qualidade da calibração rudimentar disponível ao primeiro de
filtragem do experimento. A média da distribuição é polarizada pela qualidade
da calibração disponível no LVL2. Para o histograma de jatos a média
aproxima-se ao valor esperado de 25 GeV, exibindo um pico pronunciado ao redor
da média. Como é possível observar, grande parte dos jatos encontram-se com
valor de energia transversa entre 10 e 40~GeV, enquanto que para elétrons, a
distribuição decai suavemente até cerca depois 90~GeV (massa do bóson Z em
repouso).

\begin{figure}
\begin{center}
\includegraphics{transverse-energy}
\end{center}
\caption{A deposição total de energia em uma região $0,4 \times 0,4$ no plano
$\eta\times\phi$ para elétrons (em cima) e jatos (em baixo) para a massa de
dados disponível para o estudo.}
\label{fig:transverse-energy}
\end{figure}

Nas Figuras~\ref{fig:em-tenergy} e \ref{fig:had-tenergy} é possível observar
histogramas para elétrons (em cima) e jatos (em baixo) da energia transversa
total por seção dos calorímetros. Nota-se que para elétrons quase 100\% da
energia total do objeto é retida na seção e.m., enquanto que para jatos
observa-se vazamento na seção hadrônica. Embora o corte realizado pelo
LVL1 tenha sido em 2~GeV para o vazamento de energia nesta seção, observa-se
que logo após este valor a energia total na seção decai rapidamente donde
conclui-se que a cauda estaria possivelmente relacionada a qualidade da
calibração dos dados para este nível de filtragem.

\begin{figure}
\begin{center}
\includegraphics{em-tenergy}
\end{center}
\caption{A deposição total de energia na seção e.m. em uma região $0,4 \times
0,4$ no plano $\eta\times\phi$ para elétrons (em cima) e jatos (em baixo) para
a massa de dados disponível para o estudo.}
\label{fig:em-tenergy}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics{had-tenergy}
\end{center}
\caption{A deposição total de energia na seção hadrônica em uma região $0,4 \times
0,4$ no plano $\eta\times\phi$ para elétrons (em cima) e jatos (em baixo) para
a massa de dados disponível para o estudo.}
\label{fig:had-tenergy}
\end{figure}

As Figuras~\ref{fig:rcore} e \ref{fig:eratio} mostram respectivamente a fração
\rcore e \eratio tal como utilizada pelo EGammaHypo para definir a eficiência
de deteção de elétrons e jatos. Na Figura~\ref{fig:rcore} observa-se que a
distribuição para elétrons tem média bastante próxima a 1 e baixíssima
variância. Para jatos a média é mais baixa e a distribuição apresenta longa
cauda em direção à origem. No caso da variável \eratio, que tem por objetivo
detetar picos de deposição energética na primeira camada e.m., para elétrons
observa-se um pico dominante em 1 ao passo que para jatos, uma distribuição
mais uniforme, indicando uma separabilidade linear.

As Figuras~\ref{fig:eta} e \ref{fig:phi} contém histogramas para elétrons (em
cima) e jatos (embaixo) dos centros refinados pelo T2Calo das RoI's em
questão, tanto em relação à variável $\eta$ quanto à variavel $\phi$. É
possível distinguir uma uniformidade na distribuição em $\phi$ e uma tendência
a concentração de eventos nas proximidades de $\eta=0$, como espera-se no
experimento. 

Exceto por eventuais problemas na lógica de simulação (Monte Carlo) e filtragem
(pelo LVL1), espera-se que a massa de dados seja representativa do problema da
separação entre jatos e elétrons. Deve ser levado em consideração que, para
jatos, o pico ao redor de 25~GeV poderá introduzir imprecisões na definição da
capacidade de deteção de elétrons bastante energéticos, presentes na massa de
estudo. Sempre que possível, tentar-se-á levar estas restrições em
consideração.

\subsubsection{Deteção de elétrons com o EGammaHypo e sua otimização}

Para que a qualidade deteção do algoritmo proposto pelo EGammaHypo seja
estimada, deve-se passar a massa de dados de estudo por um processo de
otimização que ajude o especialista a selecionar os patamares de corte que
definem o algoritmo, como exposto na Seção~\ref{sec:classic-detection}. Para
tal dividiu-se o conjunto de dados em 2 metades com aproximadamente o mesmo
número de RoI's. A primeira metade será utilizada para o ``treinamento'' ou
otimização dos cortes enquanto que a segunda será utilizada para o teste dos
cortes, garantindo a imparcialidade do processo.

O algoritmo de otimização não será exaustivo, varrendo todo o espaço de dados,
mas partirá de patamares pré-fixados em valores intuitivos e definirá uma
sub-área de variação por onde testará exaustivamente as combinações dos 4
cortes necessários.

\section{Métodos Neurais de Discriminação}

Redes neurais artificiais (RNA) vem sendo atualmente utilizadas com sucesso em
problemas de otimização, controle e reconhecimento de padrões
\cite{haykin}. RNA's são modelos matemáticos inspirados no
conhecimento limitado que temos do cérebro animal. Neste contexto, entende-se
que uma rede neural pode aprender através do contato com os elementos de
interesse de um determinado espaço de entrada e que este conhecimento é
armazenado através das conexões sinápticas que conectam os elementos
processadores (neurônios) da rede. Dentre as características de uma RNA
podemos destacar:

\begin{description}
\item[Robustez] Em ambientes extremamente \emph{agressivos} (sujeitos a falhas
e a radiotividade), como é o caso da operação do LVL2, RNA's podem manter um
excelente desempenho, mesmo quando parte dos dados (canais de aquisição) de
entrada são perdidos;

\item[Generalização] RNA's podem extrair a informação relevante escondida sob
uma grande quantidade de ruído;

\item[Deteção de novos fenômenos] RNA's podem detetar a ocorrência de novos
objetos de forma bastante eficaz. Isto é \underline{extremamente} importante
em ambientes que podem revelar resultados inesperados (nova física);

\item[Simples implementação] RNA's podem ser facilmente descritas em
linguagens de programação convencionais, atingindo desempenhos satifatórios
para um grande conjunto de aplicações em tempo real.
\end{description}

\subsection{Definição de uma rede neural artificial}

Um neurônio de uma RNA pode ser modelado por um grafo de fluxo como mostrado
na Figura~\ref{fig:neuron}. 

\begin{figure}
\begin{center}
\includegraphics{neuron}
\end{center}
\caption{Um grafo de fluxo de sinal de um neurônio artificial.}
\label{fig:neuron}
\end{figure}

Este estudo está focado na utilização de RNA's completamente conectadas, sem
realimentação e com treinamento baseado na retropropagação de erros. RNA's
completamente conectadas são aquelas onde os neurônios estão compartiment

\subsection{Discriminador de Fischer}

\subsection{PCA}

\section{Mapeamento topológico e discriminação neural: o \emph{neuralringer}}

Fazer uma descrição detalhada do sistema que mapeia em anéis, a informação da
RoI. Aplicação de uma rede neural como discriminador (hipótese).

\subsection{Implementação inicial}

Explicação da escolha da linguagem C++. Técnicas de programação concorrente,
fazer referência ao sistema de filtragem multi-tarefas, explicitado
anteriormente. Mostrar trechos de código e explicar a portabilidade do
sistema. Dar ao leitor, um visual de como é possível gerar os dados (arquivos
RFD) e depois usá-los para fazer testes.

\subsection{Análise física}

Esta seção vai falar do desempenho "físico" do neuralringer. Quão melhor é que
o T2Calo na deteção de elétrons e jatos. As divergências nos cálculos podem
ser restaurandas usando-se combinações de aneis, tais como a energia total,
etc.

Colocar os diversos tipos de análise que temos até agora.

\subsection{Análise de relevância}

Nesta seção vamos fazer a análise da relevância. Uma coisa que me vem a cabeça
seria um gráfico mostrando quais anéis são mantidos a cada iteração de
cortes. Explicar que não tem muito sentido ficar cortando sem parar, uma vez
que dificulta o método.

\subsection{Análise comportamental}

Nesta seção (vc pode mudar o título se quiser), devemos fazer uma estimativa,
no mínimo, do que se ganharia dividindo o sistema usando-se camadas, como é o
caso do T2Calo.

\subsection{Outras implementações}

\subsubsection{Athena}

Como portar o algoritmo para o Athena. Dificuldades, linhas gerais.

\subsubsection{Implementação com DSPs}

Perguntar ao Seixas/Torres antes de incluir este material. A abordagem aqui é
para indicar a portabilidade do sistema.

\typeout{ *************** End of file neuralringer.tex *************** }
